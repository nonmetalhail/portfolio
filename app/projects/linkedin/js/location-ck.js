function philtr(){this.latitude="";this.longitude="";this.photos=[];this.getUserLocation=function(){var e=this,t=$.Deferred();if(navigator.geolocation){navigator.geolocation.getCurrentPosition(t.resolve,t.reject);return t.promise()}document.getElementById("locationData").innerHTML="Sorry - your browser doesn't support geolocation!"};this.getLatLong=function(t){var n=this,r=$.Deferred();e(t,n);r.resolve();return r.promise()};var e=function(e,t){t.latitude=e.coords.latitude;t.longitude=e.coords.longitude;var n="User latitude is "+t.latitude+" and longitude is "+t.longitude;document.getElementById("locationData").innerHTML=n},t=function(e){var t=document.getElementById("locationData");switch(e.code){case e.PERMISSION_DENIED:t.innerHTML="Permission was denied";break;case e.POSITION_UNAVAILABLE:t.innerHTML="Location data not available";break;case e.TIMEOUT:t.innerHTML="Location request timeout";break;case e.UNKNOWN_ERROR:t.innerHTML="An unspecified error occurred";break;default:t.innerHTML="Who knows what happened..."}};this.callInstagram=function(){var e=$.Deferred(),t=this,n="https://api.instagram.com/v1/media/search?",r="lat="+this.latitude+"&lng="+this.longitude,i="&client_id=c7367a799fe34e03829b0613a743fa92&callback=?";$.getJSON(encodeURI(n+r+i),function(e){console.log(e);t.photos=e.data}).done(function(t){e.resolve(t)}).fail(e.reject);return e.promise()};this.loadPhotos=function(){console.log(this.photos);for(var e in this.photos){var t=this.photos[e].images.thumbnail.url;$("#photos").append("<img src="+t+"/>")}}}function run(){$.when(myPhiltr.getUserLocation()).pipe(myPhiltr.getLatLong).then(myPhiltr.callInstagram);myPhiltr.loadPhotos}var myPhiltr=new philtr;